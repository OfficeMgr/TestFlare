<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="5" MadCap:lastHeight="870" MadCap:lastWidth="1099">
    <head>
        <meta http_equiv="Content-Language" content="en-us" /><title>CDS184 - Attach file to email</title>
        <link rel="stylesheet" type="text/css" href="Resources/Stylesheets/tools.css" />
    </head>
    <body>
        <p class="SectionName">CDS184</p>
        <table class="revision">
            <tr>
                <td>
                    <p class="SectionTitle">Attach file to email</p>
                </td>
                <td align="right"><a target="_blank" href="http://dynaweb.excellware.com/cgi-bin/tools.cgi?p=r&amp;pgm=CDS184">Last Revised: 02/12/16</a>
                </td>
            </tr>
        </table>
        <p class="SectionDesc">The routine is used to attach a file to an email that was initiated using 
	<a href="CDS084.htm">CDS084</a>.&#160; The file can be of any size or type.</p>
        <p>Calling Format:</p>
        <p><code>CALL "CDS184", ERR=NO_OPEN, Y$, Y6$, FILNAM$ {, TXTNAM$ }</code>
        </p>
        <table>
            <tr>
                <th colspan="2">CDS184</th>
            </tr>
            <tr>
                <td><code>NO_OPEN</code>
                </td>
                <td>Line to branch to if CDS184 cannot open <code>FILNAM$</code>.&#160; Some possible 
		errors include: error 0 if file is locked by another user, error 12 if 
		file does not exist, or error 18 if user does not have permissions to 
		open file. The user will be prompted with the specific error unless running as a background task, and the program is dated 02/12/16 or later.</td>
            </tr>
            <tr>
                <td><code>Y$</code>
                </td>
                <td>Task Control Variable from Menu Processor</td>
            </tr>
            <tr>
                <td><code>Y6$</code>
                </td>
                <td>Printer Control Variable from CDS084</td>
            </tr>
            <tr>
                <td><code>FILNAM$</code>
                </td>
                <td>The path to the file name to be attached.</td>
            </tr>
            <tr>
                <td><code>TXTNAM$</code>
                </td>
                <td>The name for the file that the email client will see when they go to save the attached file.&#160; This name cannot contain / or \ characters, nor a DOS drive letter.&#160; This field is optional.&#160; If not passed, or passed as null, then the base file name from 
		<code>FILNAM$</code> will be used.</td>
            </tr>
        </table>
        <p>You may call CDS184 multiple times to attach multiple files to the same email.</p>
        <p>For large files, CDS184 will display a progress message as the file is 
	processed.</p>
        <p>CDS184 looks at the extension of <code>FILNAM$</code> to determine the 
	MIME Content Type which describes the type of attachment.&#160; The Content 
	Types supported are shown below.</p>
        <table border="1" id="table1">
            <tr>
                <th>File Name Extension</th>
                <th>MIME Content Type</th>
            </tr>
            <tr>
                <td>pdf</td>
                <td>application/pdf</td>
            </tr>
            <tr>
                <td>json</td>
                <td>application/json</td>
            </tr>
            <tr>
                <td>js</td>
                <td>application/javascript</td>
            </tr>
            <tr>
                <td>htm, html, xhtml, xml</td>
                <td>application/xhtml+xml</td>
            </tr>
            <tr>
                <td>dtd</td>
                <td>application/xml-dtd</td>
            </tr>
            <tr>
                <td>zip</td>
                <td>application/zip</td>
            </tr>
            <tr>
                <td>gz</td>
                <td>application/x-gzip</td>
            </tr>
            <tr>
                <td>css</td>
                <td>text/css</td>
            </tr>
            <tr>
                <td>txt</td>
                <td>text/plain</td>
            </tr>
            <tr>
                <td>csv</td>
                <td>text/tab-separated-values</td>
            </tr>
            <tr>
                <td>vcf</td>
                <td>text/x-vcard</td>
            </tr>
            <tr>
                <td>bmp</td>
                <td>image/bmp</td>
            </tr>
            <tr>
                <td>gif</td>
                <td>image/gif</td>
            </tr>
            <tr>
                <td>jpg, jpe, jpeg</td>
                <td>image/jpeg</td>
            </tr>
            <tr>
                <td>png</td>
                <td>image/png</td>
            </tr>
            <tr>
                <td>tif, tiff</td>
                <td>image/tiff</td>
            </tr>
            <tr>
                <td>ico</td>
                <td>image/x-icon</td>
            </tr>
            <tr>
                <td>*any other*</td>
                <td>application/octet-stream</td>
            </tr>
        </table>
    </body>
</html>